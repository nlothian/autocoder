# AI Workflow Tools

Automation helpers that wire together git, GitHub, and external AI coding assistants.
Each subdirectory is self-contained, depends only on the Python stdlib plus CLI tools
like `gh`, `llm`, `kilocode`, and `claude`, and can be run via `uv` or as an executable script.

## Layout

- `autocoder_utils/`: Shared Python helpers used by the Kilocode/Claude flows (see [Autocoder Utils](#autocoder-utils) below).
- `change-tracker/`: Git changelog generator used by the scheduled workflow.
- `gh-pr-helper/`: Standalone formatter that fetches and prints PR review comments.
- `kilocode/`: Scripts that orchestrate Kilocode workflows along with git and GitHub.
- `claude/`: Executable shims for running the Claude workflows.
- `codex/`: Executable shims for the Codex workflows.

## Requirements

Install the following CLIs and ensure they are available on `PATH`:

- `uv` (for running these tools)
- `git`
- `gh` (GitHub CLI, authenticated with the target repo)
- `llm`
- `kilocode` (Kilocode automation)
- `claude` (Claude automation)
- `codex` (ChatGPT Codex CLI)

Environment variables:

- `OPENAI_API_KEY` must be set (used by `llm`)
- Optional `LLM_MODEL` override (defaults to `gpt-5-nano`)

Repository assumptions:

- Commands run inside a git repository whose default branch is `main`
- Remote name `origin` exists (used for `git log origin/main..`)

## Installation

Run directly from the repo without installing:
   ```bash
   uv tool run --from ./ fix-issue-with-kilocode 123
   uv tool run --from ./ address-pr-comments-with-kilocode 456
   uv tool run --from ./ fix-issue-with-claude 789
   uv tool run --from ./ address-pr-comments-with-claude 1011
   uv tool run --from ./ fix-issue-with-codex 1213
   uv tool run --from ./ address-pr-comments-with-codex 1415
   uv tool run --from ./ gh-pr-helper owner/repo/pull/42
   uv tool run --from ./ generate-changelog
   ```


## uv project

A single `pyproject.toml` lives at `pyproject.toml`, so every script
shares the same environment. Each tool exposes a console entry point that `uv`
can resolve, so the preferred workflow is:

```bash
uv tool run --from ./ fix-issue-with-kilocode 123
uv tool run --from ./ address-pr-comments-with-kilocode 456
uv tool run --from ./ fix-issue-with-claude 789
uv tool run --from ./ address-pr-comments-with-claude 1011
uv tool run --from ./ fix-issue-with-codex 1213
uv tool run --from ./ address-pr-comments-with-codex 1415
uv tool run --from ./ gh-pr-helper owner/repo/pull/42
uv tool run --from ./ generate-changelog
```

Every script also retains its executable shebang, so you may invoke them
directly via `.//...` if you prefer.

## Change tracker

`change-tracker/generate-changelog.py` walks git history, computes stats,
and writes daily markdown changelog entries under `changes/`. It is used by the
`generate-changelog.yml` GitHub Action but may also be run manually:

```bash
uv tool run --from ./ generate-changelog
```

## Kilocode tools

### `fix-issue-with-kilocode`

Given an issue number, the script fetches the issue via `gh`, generates a branch
name prefixed with `fix-kilocode/<issue>`, runs `kilocode --auto` with the issue
details, stages/commits changes, pushes the branch, and opens a PR using content
generated by `llm`.

Usage:

```bash
uvx --refresh --from ./ fix-issue-with-kilocode 123 --timeout off
# or 
uv tool run --from ./ fix-issue-with-kilocode 123
# or, after installing the package:
uv tool run fix-issue-with-kilocode 123
# or invoke the script directly:
.//kilocode/fix-issue-with-kilocode 123
```

### `address-pr-comments-with-kilocode`

Automates addressing review comments on an existing PR. It identifies the PR
branch, checks it out, pulls the latest changes, collects PR comments via
`gh-pr-helper/gh-pr-helper`, feeds them to `kilocode --auto`, stages
and commits the updates with an AI-generated message, and pushes.

Usage:

```bash
uv tool run --from ./ address-pr-comments-with-kilocode 456
```

## Autocoder Utils

This package provides shared utilities for AI-powered coding automation tools in the ai-tools directory.

### Overview

The `autocoder_utils` module contains common helper functions used by various AI coding automation scripts, including:

- Command availability checking
- Environment setup (API keys, LLM configuration)
- Git operations (staging, checking for changes, repository metadata)
- Subprocess execution with error handling

### Functions

#### Command and Environment

- `check_commands_available(required)`: Verify that required CLI tools are installed
- `ensure_env()`: Ensure required environment variables are set

#### Git Operations

- `stage_changes()`: Stage all changes with `git add -A`
- `has_staged_changes()`: Check if there are staged changes
- `get_repo_root()`: Get the root directory of the git repository
- `get_owner_repo()`: Extract owner and repository name from git remote URL

#### Utilities

- `run(cmd, input_text=None, capture_output=True)`: Execute a command with proper error handling

### Usage

```python
from autocoder_utils import check_commands_available, ensure_env, run

# Check for required tools
check_commands_available(["gh", "llm", "kilocode"])

# Ensure environment is set up
ensure_env()

# Run a command
output = run(["git", "status"])
```

### Dependencies

This module has no external dependencies beyond Python's standard library.

### Testing

Tests for autocoder_utils are located in `tests/test_autocoder_utils.py` and can be run with:

```bash
uv run pytest tests/test_autocoder_utils.py
```

Additional tests for gh_pr_helper are located in `tests/test_gh_pr_helper.py`:

```bash
uv run pytest tests/test_gh_pr_helper.py
```

## Claude tool

### `fix-issue-with-claude`

Mirrors the Kilocode issue workflow but uses the `claude` CLI. It creates a
branch named `fix-claude/<issue>...`, runs `claude` with the issue content,
stages/commits the changes, pushes, and raises a PR.

Usage:

```bash
uv tool run --from ./ fix-issue-with-claude 123
```

### `address-pr-comments-with-claude`

Runs the PR comment workflow but drives the Claude headless CLI. It reads PR
feedback, prepares condensed instructions, passes them to Claude, stages and
commits updates, and pushes them upstream.

Usage:

```bash
uv tool run --from ./ address-pr-comments-with-claude 456
```

## Codex tools

### `fix-issue-with-codex`

Behaves like the Claude issue workflow but uses `codex exec` in headless mode
(`--full-auto --sandbox danger-full-access`). Issue content is piped to Codex so
it can read the description, make edits, run tests, and summarize.

Usage:

```bash
uv tool run --from ./ fix-issue-with-codex 123
```

### `address-pr-comments-with-codex`

Mirrors the Claude PR comment flow while driving Codex. Review feedback is
condensed into precise instructions that Codex consumes via stdin before making
changes, staging, committing, and pushing updates.

Usage:

```bash
uv tool run --from ./ address-pr-comments-with-codex 456
```
